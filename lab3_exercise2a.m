clc;
clear;


%Adam bashford
%lab3_ex2a(5,100,1,0);
%lab3_ex2a(5,100,2,0);
lab3_ex2a(5,500,3,0.7);

function [E, A] = lab3_ex2a(P, N, k, e)

h = 2*pi/N;

x = zeros(2,P*N+1);

y = zeros(2,P*N+1);
t = 0:h:P*N;

x(1,1) = 1-e;
x(2,1) = 0;
y(1,1) = 0;
y(2,1) = ((1+e)/(1-e))^0.5;

E = zeros(1, P*N+1);
A = zeros(1, P*N+1);

r1 = sqrt(x(1,1)^2 + y(1,1)^2);
E(1) = 0.5 * (x(2,1)^2 + y(2,1)^2) - 1 / r1;
A(1) = x(1,1) * y(2,1) - y(1,1) * x(2,1);

if k==1
    for n = 1:P*N
        x(:,n+1) = x(:,n) + h*[x(2,n);-x(1,n)/(x(1,n)^2 + y(1,n)^2)^1.5];
        y(:,n+1) = y(:,n) + h*[y(2,n);-y(1,n)/(x(1,n)^2 + y(1,n)^2)^1.5];
        r = sqrt(x(1,n+1)^2 + y(1,n+1)^2);
        E(n+1) = 0.5 * (x(2,n+1)^2 + y(2,n+1)^2) - 1 / r;
        A(n+1) = x(1,n+1) * y(2,n+1) - y(1,n+1) * x(2,n+1);
        
    end    

elseif k==2
    x(:,1+1) = x(:,1) + h*[x(2,1);-x(1,1)/(x(1,1)^2 + y(1,1)^2)^1.5];
    y(:,1+1) = y(:,1) + h*[y(2,1);-y(1,1)/(x(1,1)^2 + y(1,1)^2)^1.5];
    for n = 2:P*N
        x(:,n+1) = x(:,n) + 1.5*h*[x(2,n);-x(1,n)/(x(1,n)^2 + y(1,n)^2)^1.5] - 0.5*h*[x(2,n-1);-x(1,n-1)/(x(1,n-1)^2 + y(1,n-1)^2)^1.5];
        y(:,n+1) = y(:,n) + 1.5*h*[y(2,n);-y(1,n)/(x(1,n)^2 + y(1,n)^2)^1.5] - 0.5*h*[y(2,n-1);-y(1,n-1)/(x(1,n-1)^2 + y(1,n-1)^2)^1.5];
        
    end 
else
    x(:,1+1) = x(:,1) + h*[x(2,1);-x(1,1)/(x(1,1)^2 + y(1,1)^2)^1.5];
    y(:,1+1) = y(:,1) + h*[y(2,1);-y(1,1)/(x(1,1)^2 + y(1,1)^2)^1.5];
    x(:,2+1) = x(:,2) + 1.5*h*[x(2,2);-x(1,2)/(x(1,2)^2 + y(1,2)^2)^1.5] - 0.5*h*[x(2,2-1);-x(1,2-1)/(x(1,2-1)^2 + y(1,2-1)^2)^1.5];
    y(:,2+1) = y(:,2) + 1.5*h*[y(2,2);-y(1,2)/(x(1,2)^2 + y(1,2)^2)^1.5] - 0.5*h*[y(2,2-1);-y(1,2-1)/(x(1,2-1)^2 + y(1,2-1)^2)^1.5];
    for n = 3:P*N
        x(:,n+1) = x(:,n) + h*23*[x(2,n);-x(1,n)/(x(1,n)^2 + y(1,n)^2)^1.5]/12 - 4*h*[x(2,n-1);-x(1,n-1)/(x(1,n-1)^2 + y(1,n-1)^2)^1.5]/3  + 5*h*[x(2,n-2);-x(1,n-2)/(x(1,n-2)^2 + y(1,n-2)^2)^1.5]/12;
        y(:,n+1) = y(:,n) + h*23*[y(2,n);-y(1,n)/(x(1,n)^2 + y(1,n)^2)^1.5]/12 - 4*h*[y(2,n-1);-y(1,n-1)/(x(1,n-1)^2 + y(1,n-1)^2)^1.5]/3  + 5*h*[y(2,n-2);-y(1,n-2)/(x(1,n-2)^2 + y(1,n-2)^2)^1.5]/12;
    end    
end




plot(x(1,:),y(1,:));



end

